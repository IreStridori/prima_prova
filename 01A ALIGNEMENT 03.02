from Bio.Align import PairwiseAligner
# Classe per l'allineamento
class SequenceAlignment:
    def __init__(self, seq1, seq2):
        """Inizializza l'oggetto di allineamento con due sequenze."""
        self.__seq1 = seq1
        self.__seq2 = seq2
        self.__aligner = PairwiseAligner()
        self.__aligner.mode = 'global'  # Imposta l'allineamento globale di default
        self.__alignements=None
        
        
    def perform_alignement(self):
        self.__alignements =self.__aligner.align(self.__seq1, self.__seq2)
        return self.__alignements

    def format_alignment(self, n=1):
        """Formatta e restituisce i primi N risultati di allineamento."""
        results = []
        for alignment in self.__alignements[n]:
            results.append(str(alignment))
        return "\n".join(results)
    
    def alignments_score(self):
        return self.__alignements.score
    
aligner = SequenceAlignment(DataFrame.loc[1, 'Sequence'], DataFrame.loc[76, 'Sequence'])
aligner.perform_alignement()
print(aligner.format_alignment(n=89))
print(aligner.alignments_score())
