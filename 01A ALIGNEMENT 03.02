from Bio.Align import PairwiseAligner
#Viene importata la classe PairwiseAligner dalla libreria Bio.Align di Biopython, che è una libreria molto usata per la bioinformatica. La classe PairwiseAligner è utilizzata per effettuare allineamenti di sequenze biologiche (come DNA, RNA o proteine) utilizzando vari algoritmi.

# Classe per l'allineamento
class SequenceAlignment:
    def __init__(self, seq1, seq2): #Inizializza l'oggetto di allineamento con due sequenze.
        self.__seq1 = seq1
        self.__seq2 = seq2
        self.__aligner = PairwiseAligner()
        self.__aligner.mode = 'global'  # Imposta l'allineamento globale di default
        self.__alignments = None # Variabile per memorizzare i risultati dell'allineamento

    def perform_alignment(self): #esegue l'allineamento
        self.__alignments = self.__aligner.align(self.__seq1, self.__seq2)
        return self.__alignments

    def format_alignment(self, n=1): #Formatta e restituisce i primi N risultati di allineamento
        results = []
        for alignment in self.__alignments[n]:
            results.append(str(alignment))
        return "\n".join(results)

    def alignments_score(self): #Questa funzione restituisce il punteggio dell'allineamento (ovvero la qualità dell'allineamento stesso), che è una misura di quanto siano simili le due sequenze.
        return self.__alignments.score


aligner = SequenceAlignment(DataFrame.loc[1, 'Sequence'], DataFrame.loc[76, 'Sequence'])
aligner.perform_alignement()
print(aligner.format_alignment(n=89))
print(aligner.alignments_score())
